package="msir"

# compila e installa 
lib="/Library/Frameworks/R.framework/Resources/library"
cd ~/R

# check
# R --vanilla CMD check $package

# crea pacchetto
R --vanilla CMD build --force $package
# on windows: R CMD build --force --binary irt

# remove old package
sudo R --vanilla CMD REMOVE --library="$lib" $package

# install latest package version
filepkg=$(ls -t $package*.tar.gz)
filepkg=$(echo $filepkg | awk '{print $1}')
sudo R --vanilla CMD INSTALL --library="$lib" $filepkg

# installa in Linux
sudo R --vanilla
remove.packages("msir")
install.packages("<name>", lib = .libPaths()[2])

# crea pacchetto per Windows
lib="/Library/Frameworks/R.framework/Resources/library"
cd ~/tmp
cp $lib/irt .
zip -r ~/R/$package.zip $package
rm -rf $package
cd ~/R


### byte-compiler

library(compiler)
cmpfile(infile = "/Users/luca/R/msir/R/msir.R", 
        outfile = "/Users/luca/R/msir/R/msir.Rc")

library(msir)
...
system.file(MSIR <- msir(X, Y))
   user  system elapsed 
 64.096   0.772  64.971 
detach(package:msir)

loadcmp("/Users/luca/R/msir/R/msir.Rc")
system.time(MSIRc <- msir(X, Y))
64.856   0.786  65.725

source("/Users/luca/R/msir/R/msir.R")
MSIR <- msir
loadcmp("/Users/luca/R/msir/R/msir.Rc")
rm(msir)
msir <- cmpfun(MSIR)
system.time(MSIRc <- msir(X, Y))
   user  system elapsed 
 64.149   0.878  65.891
